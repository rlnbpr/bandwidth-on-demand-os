<html xmlns:jsp="http://java.sun.com/JSP/Page" xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:tiles="http://tiles.apache.org/tags-tiles" xmlns:spring="http://www.springframework.org/tags"
    xmlns:sec="http://www.springframework.org/security/tags" xmlns:menu="urn:jsptagdir:/WEB-INF/tags/menu"
    xmlns:util="urn:jsptagdir:/WEB-INF/tags/util">

    <jsp:output doctype-root-element="HTML" doctype-system="about:legacy-compat" />
    
    <jsp:directive.page contentType="text/html;charset=UTF-8" />
    <jsp:directive.page pageEncoding="UTF-8" />
    
    <spring:message code="application_name" var="app_name" htmlEscape="false" />
    <spring:url var="banner" value="/resources/images/surfnet_logo.gif" />
    <spring:url var="home" value="/" />
    
    <spring:message code="button_home" var="home_label" htmlEscape="false" />
    <spring:message var="app_name" code="application_name" htmlEscape="false" />
    
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=8" />

        <util:load-scripts />

        <title><spring:message code="welcome_h3" arguments="${app_name}" /></title>
    </head>

    <body>
        <div class="topbar" data-dropdown="dropdown">
            <a href="${home}"><img src="${banner}" class="logo" /></a>
    
            <h1>${app_name}</h1>
            <div class="topbar-inner">
                <div class="container">
                    <div class="topbar-wrapper"> 
                        <tiles:insertAttribute name="menubar" ignore="true" />
                        <ul class="nav secondary-nav">
                            <c:set var="displayName" >
                                <sec:authentication property="principal.displayName" htmlEscape="false"/>
                            </c:set>
                            <c:choose>
                                <c:when test="${not empty displayName}">
                                    <menu:menu id="user_menu">
                                        <menu:category id="c_user" label="${displayName}">
                                            <menu:item id="i_refresh" url="/shibboleth/refresh" messageCode="security_refresh" />
                                            <menu:item id="i_logout" url="/Shibboleth.sso/Logout?target=/" messageCode="global_menu_logout" />
                                        </menu:category>
                                    </menu:menu>
                                </c:when>
                                <c:otherwise>
                                    <menu:menu id="user_menu">
                                        <menu:item url="#" id="no_auth" messageCode="security_not_authenticated" />
                                    </menu:menu>
                                </c:otherwise>
                            </c:choose>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    
        <div class="messagebar">
            <div id="messages">
                <!-- -->
            </div>
        </div>
        <div class="container">
            <tiles:insertAttribute name="body" />
        </div>
    </body>
</html>
