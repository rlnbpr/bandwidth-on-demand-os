<html xmlns:jsp="http://java.sun.com/JSP/Page" xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:tiles="http://tiles.apache.org/tags-tiles" xmlns:spring="http://www.springframework.org/tags"
    xmlns:sec="http://www.springframework.org/security/tags" xmlns:menu="urn:jsptagdir:/WEB-INF/tags/menu"
    xmlns:util="urn:jsptagdir:/WEB-INF/tags/util">

    <jsp:output doctype-root-element="HTML" doctype-system="about:legacy-compat" />
    
    <jsp:directive.page contentType="text/html;charset=UTF-8" />
    <jsp:directive.page pageEncoding="UTF-8" />
    
    <spring:message code="application_name" var="app_name" htmlEscape="false" />
    <spring:url var="banner" value="/resources/images/surfnet_logo.gif" />
    <spring:url var="home" value="/" />
    
    <spring:message code="button_home" var="home_label" htmlEscape="false" />
    <spring:message var="app_name" code="application_name" htmlEscape="false" />
    
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=8" />

        <util:load-scripts />

        <title><spring:message code="welcome_h3" arguments="${app_name}" /></title>
    </head>

    <body>
        <div class="wrapper">
            <header>
                <h1>${app_name}</h1>
            </header>
            
            <section class="user-box content-dense">
                <span class="user-name"><sec:authentication property="principal.displayName" htmlEscape="false"/></span>
            	<spring:url value="/switchrole/logout" var="logoutUrl" />
                 
                <a href="${logoutUrl}" class="logout">Logout <i class="icon-signout"><!-- --></i></a>
                
                <br/>
                <div class="dropdown dropdown-disabled">
                    <sec:authentication property="principal.bodRoles" var="bodRoles"/>
                    <c:choose>
                        <c:when test="${not empty bodRoles}">
                            <sec:authentication property="principal.selectedRole" var="selectedRole" />
                            <spring:message code="role_class_${selectedRole.roleName}" var="s_role_class"/>
                            <div class="dropdown-toggle ${s_role_class}" data-toggle="dropdown">
                                <span class="user-icon"><!--  --></span>
                                <span class="user-title"><spring:message  code="role_${selectedRole.roleName}"/></span>
                                <b class="caret"><!--  --></b>
                                <span class="user-group">
                            		<c:choose>
                            			<c:when test="${not empty selectedRole.instituteName}">
                            				<c:out value="${selectedRole.instituteName}"/>
                            			</c:when>
                            			<c:otherwise>
                            				<!--  -->
                            			</c:otherwise>
                           		   </c:choose>
                            	</span>
                            </div>
                            <spring:url value="/switchrole" var="postUrl" />
                            <form action="${postUrl}" method="POST" class="dropdown-menu">
                                <ul>
                                    <c:forEach items="${bodRoles}" var="bodRole">
                                        <spring:message  code="role_class_${bodRole.roleName}" var="role_class"/>
    			                        <li class="${role_class}" data-roleId="${bodRole.id}">
    		                                <span class="user-icon"><!--  --></span>
    		                                <span class="user-title"><spring:message  code="role_${bodRole.roleName}"/></span>
    		                                <span class="user-group">
    			                                <c:choose>
                                                    <c:when test="${not empty bodRole.instituteName}">
                                                        <c:out value="${bodRole.instituteName}"/>
    			                        			</c:when>
    			                        			<c:otherwise>
    			                        				<!--  -->
    			                        			</c:otherwise>
    	                       					</c:choose>
    	                       				</span>
    			                        </li>
                                    </c:forEach>
                                </ul>
                            </form>
                        </c:when>
                        <c:otherwise>
                            <spring:message  code="role_class_DEFAULT" var="role_class"/>
                            <div class="dropdown-toggle ${role_class}" data-toggle="dropdown">
                                <span class="user-icon"><!--  --></span>
                                <span class="user-title"><spring:message  code="role_DEFAULT"/></span>
                            </div>
                        </c:otherwise>
    				</c:choose>
                </div>
            </section>
            
            <nav class="navbar">
                <div class="navbar-inner">
                    <div class="container">
                        <tiles:insertAttribute name="menubar" ignore="true" />
                    </div>
                </div>
            </nav>

            <c:forEach items="${infoMessages}" var="infoMessage">
                <div class="alert alert-info">
                    <a class="close" data-dismiss="alert">&amp;times;</a>
                    <c:out value="${infoMessage}" escapeXml="false"/>
                </div>
            </c:forEach>

            <tiles:insertAttribute name="body" />

            <footer>
                <div class="content-some-dense">
                    SURFnet bv | Postbus 190-35, 3501 DA Utrecht | T +31 302 305 305 | F +31 302 305 329 | <a href="mailto:admin@surfnet.nl">Admin@SURFnet.nl</a>
                </div>
            </footer>

        </div>
    </body>
</html>
